# FileContainer

Key/value file container.
File organized with fixed-size pages.

### Run benchmark

Run `Benchmark project` - .net 6 targeted

### Speed tests

| Method | BatchSize | PageSize |               Flags | Compress |      Mean | Avg MB/sec | Lost%/Compress |       Gen0 |      Gen1 |      Gen2 | Allocated |
|------- |---------- |--------- |-------------------- |--------- |----------:|----------- |--------------- |-----------:|----------:|----------:|----------:|
| Single |         1 |      256 |                   0 |     None |  15.54 ms |    1216.96 |            2.1 |  1000.0000 | 1000.0000 | 1000.0000 |  83.37 MB |
| Single |         1 |      256 |                   0 |     GZip | 390.88 ms |      26.46 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  80.06 MB |
| Single |         1 |      256 |                   0 |      LZ4 |  41.27 ms |     325.26 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.34 MB |
| Single |         1 |      256 | WriteDirImmediately |     None |  47.57 ms |     397.56 |            2.1 |  4000.0000 | 1000.0000 | 1000.0000 | 106.27 MB |
| Single |         1 |      256 | WriteDirImmediately |     GZip | 510.68 ms |      20.25 |           x1.8 |  5000.0000 | 1000.0000 | 1000.0000 | 106.18 MB |
| Single |         1 |      256 | WriteDirImmediately |      LZ4 |  65.53 ms |     204.84 |           x1.4 |  4000.0000 | 1000.0000 | 1000.0000 |   92.1 MB |
| Single |         5 |      256 |                   0 |     None |  15.41 ms |    1226.91 |            2.1 |  1000.0000 | 1000.0000 | 1000.0000 |  83.41 MB |
| Single |         5 |      256 |                   0 |     GZip | 386.14 ms |      26.78 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  80.12 MB |
| Single |         5 |      256 |                   0 |      LZ4 |  41.30 ms |     325.07 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.38 MB |
| Single |         5 |      256 | WriteDirImmediately |     None |  21.91 ms |     863.27 |            2.1 |  1000.0000 | 1000.0000 | 1000.0000 |  88.09 MB |
| Single |         5 |      256 | WriteDirImmediately |     GZip | 403.49 ms |      25.63 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  85.31 MB |
| Single |         5 |      256 | WriteDirImmediately |      LZ4 |  51.58 ms |     260.23 |           x1.4 |  2000.0000 | 1000.0000 | 1000.0000 |   69.9 MB |
| Single |        10 |      256 |                   0 |     None |  15.83 ms |    1194.89 |            2.1 |  1000.0000 | 1000.0000 | 1000.0000 |   83.4 MB |
| Single |        10 |      256 |                   0 |     GZip | 392.52 ms |      26.35 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  80.11 MB |
| Single |        10 |      256 |                   0 |      LZ4 |  40.74 ms |     329.48 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.36 MB |
| Single |        10 |      256 | WriteDirImmediately |     None |  18.36 ms |    1030.26 |            2.1 |  1000.0000 | 1000.0000 | 1000.0000 |  85.62 MB |
| Single |        10 |      256 | WriteDirImmediately |     GZip | 402.25 ms |      25.71 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  82.73 MB |
| Single |        10 |      256 | WriteDirImmediately |      LZ4 |  47.45 ms |     282.91 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  67.16 MB |
| Single |        25 |      256 |                   0 |     None |  15.36 ms |    1230.87 |            2.1 |  1000.0000 | 1000.0000 | 1000.0000 |  83.39 MB |
| Single |        25 |      256 |                   0 |     GZip | 387.73 ms |      26.67 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |   80.1 MB |
| Single |        25 |      256 |                   0 |      LZ4 |  41.45 ms |     323.88 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.35 MB |
| Single |        25 |      256 | WriteDirImmediately |     None |  16.51 ms |    1145.68 |            2.1 |  1000.0000 | 1000.0000 | 1000.0000 |  84.19 MB |
| Single |        25 |      256 | WriteDirImmediately |     GZip | 394.93 ms |      26.19 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  81.11 MB |
| Single |        25 |      256 | WriteDirImmediately |      LZ4 |  43.59 ms |     307.98 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  65.43 MB |
| Single |         1 |      512 |                   0 |     None |  13.34 ms |    1410.65 |            1.5 |  1000.0000 | 1000.0000 | 1000.0000 |  83.29 MB |
| Single |         1 |      512 |                   0 |     GZip | 386.75 ms |      26.68 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  80.08 MB |
| Single |         1 |      512 |                   0 |      LZ4 |  40.58 ms |     329.62 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.33 MB |
| Single |         1 |      512 | WriteDirImmediately |     None |  43.66 ms |     430.91 |            1.5 |  4000.0000 | 1000.0000 | 1000.0000 | 104.85 MB |
| Single |         1 |      512 | WriteDirImmediately |     GZip | 514.54 ms |      20.06 |           x1.8 |  5000.0000 | 1000.0000 | 1000.0000 | 105.35 MB |
| Single |         1 |      512 | WriteDirImmediately |      LZ4 |  81.83 ms |     163.48 |           x1.4 |  4000.0000 | 1000.0000 | 1000.0000 |  89.91 MB |
| Single |         5 |      512 |                   0 |     None |  13.89 ms |    1354.16 |            1.5 |  1000.0000 | 1000.0000 | 1000.0000 |  83.33 MB |
| Single |         5 |      512 |                   0 |     GZip | 388.70 ms |      26.55 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  80.14 MB |
| Single |         5 |      512 |                   0 |      LZ4 |  40.75 ms |     328.26 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.37 MB |
| Single |         5 |      512 | WriteDirImmediately |     None |  19.17 ms |     981.54 |            1.5 |  1000.0000 | 1000.0000 | 1000.0000 |  87.56 MB |
| Single |         5 |      512 | WriteDirImmediately |     GZip | 404.53 ms |      25.51 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  85.15 MB |
| Single |         5 |      512 | WriteDirImmediately |      LZ4 |  51.91 ms |     257.69 |           x1.4 |  2000.0000 | 1000.0000 | 1000.0000 |  69.44 MB |
| Single |        10 |      512 |                   0 |     None |  13.72 ms |    1370.72 |            1.5 |  1000.0000 | 1000.0000 | 1000.0000 |  83.31 MB |
| Single |        10 |      512 |                   0 |     GZip | 388.94 ms |      26.53 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  80.13 MB |
| Single |        10 |      512 |                   0 |      LZ4 |  40.43 ms |     330.83 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.35 MB |
| Single |        10 |      512 | WriteDirImmediately |     None |  17.27 ms |    1089.17 |            1.5 |  1000.0000 | 1000.0000 | 1000.0000 |  85.42 MB |
| Single |        10 |      512 | WriteDirImmediately |     GZip | 399.49 ms |      25.83 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  82.67 MB |
| Single |        10 |      512 | WriteDirImmediately |      LZ4 |  45.82 ms |     291.94 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  66.92 MB |
| Single |        25 |      512 |                   0 |     None |  13.66 ms |    1377.05 |            1.5 |  1000.0000 | 1000.0000 | 1000.0000 |   83.3 MB |
| Single |        25 |      512 |                   0 |     GZip | 385.31 ms |      26.78 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |  80.12 MB |
| Single |        25 |      512 |                   0 |      LZ4 |  39.47 ms |     338.93 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.34 MB |
| Single |        25 |      512 | WriteDirImmediately |     None |  15.98 ms |    1177.05 |            1.5 |  1000.0000 | 1000.0000 | 1000.0000 |  84.07 MB |
| Single |        25 |      512 | WriteDirImmediately |     GZip | 391.61 ms |      26.35 |           x1.8 |  2000.0000 | 1000.0000 | 1000.0000 |   81.1 MB |
| Single |        25 |      512 | WriteDirImmediately |      LZ4 |  42.71 ms |     313.24 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  65.34 MB |
| Single |         1 |     2048 |                   0 |     None |  12.10 ms |    1575.55 |            2.8 |  1000.0000 | 1000.0000 | 1000.0000 |  83.74 MB |
| Single |         1 |     2048 |                   0 |     GZip | 388.46 ms |      27.47 |           x1.7 |  2000.0000 | 1000.0000 | 1000.0000 |  80.67 MB |
| Single |         1 |     2048 |                   0 |      LZ4 |  39.62 ms |     345.79 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.89 MB |
| Single |         1 |     2048 | WriteDirImmediately |     None |  37.72 ms |     505.28 |            2.8 |  4000.0000 | 1000.0000 | 1000.0000 | 105.65 MB |
| Single |         1 |     2048 | WriteDirImmediately |     GZip | 514.25 ms |      20.75 |           x1.7 |  5000.0000 | 1000.0000 | 1000.0000 | 106.22 MB |
| Single |         1 |     2048 | WriteDirImmediately |      LZ4 |  84.01 ms |     163.07 |           x1.4 |  4000.0000 | 1000.0000 | 1000.0000 |  89.97 MB |
| Single |         5 |     2048 |                   0 |     None |  13.08 ms |    1457.51 |            2.8 |  1000.0000 | 1000.0000 | 1000.0000 |  83.78 MB |
| Single |         5 |     2048 |                   0 |     GZip | 386.08 ms |      27.64 |           x1.7 |  2000.0000 | 1000.0000 | 1000.0000 |  80.73 MB |
| Single |         5 |     2048 |                   0 |      LZ4 |  38.96 ms |     351.60 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.93 MB |
| Single |         5 |     2048 | WriteDirImmediately |     None |  17.83 ms |    1068.91 |            2.8 |  1000.0000 | 1000.0000 | 1000.0000 |  88.12 MB |
| Single |         5 |     2048 | WriteDirImmediately |     GZip | 415.65 ms |      25.68 |           x1.7 |  3000.0000 | 1000.0000 | 1000.0000 |   85.8 MB |
| Single |         5 |     2048 | WriteDirImmediately |      LZ4 |  49.06 ms |     279.24 |           x1.4 |  2000.0000 | 1000.0000 | 1000.0000 |   69.9 MB |
| Single |        10 |     2048 |                   0 |     None |  12.31 ms |    1547.91 |            2.8 |  1000.0000 | 1000.0000 | 1000.0000 |  83.77 MB |
| Single |        10 |     2048 |                   0 |     GZip | 391.93 ms |      27.23 |           x1.7 |  2000.0000 | 1000.0000 | 1000.0000 |  80.72 MB |
| Single |        10 |     2048 |                   0 |      LZ4 |  38.89 ms |     352.27 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.92 MB |
| Single |        10 |     2048 | WriteDirImmediately |     None |  15.37 ms |    1240.21 |            2.8 |  1000.0000 | 1000.0000 | 1000.0000 |  85.96 MB |
| Single |        10 |     2048 | WriteDirImmediately |     GZip | 399.75 ms |      26.70 |           x1.7 |  2000.0000 | 1000.0000 | 1000.0000 |  83.28 MB |
| Single |        10 |     2048 | WriteDirImmediately |      LZ4 |  44.55 ms |     307.53 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  67.43 MB |
| Single |        25 |     2048 |                   0 |     None |  12.29 ms |    1551.30 |            2.8 |  1000.0000 | 1000.0000 | 1000.0000 |  83.76 MB |
| Single |        25 |     2048 |                   0 |     GZip | 388.35 ms |      27.48 |           x1.7 |  2000.0000 | 1000.0000 | 1000.0000 |  80.71 MB |
| Single |        25 |     2048 |                   0 |      LZ4 |  39.97 ms |     342.75 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  64.91 MB |
| Single |        25 |     2048 | WriteDirImmediately |     None |  13.12 ms |    1453.07 |            2.8 |  1000.0000 | 1000.0000 | 1000.0000 |   84.6 MB |
| Single |        25 |     2048 | WriteDirImmediately |     GZip | 391.21 ms |      27.28 |           x1.7 |  2000.0000 | 1000.0000 | 1000.0000 |   81.7 MB |
| Single |        25 |     2048 | WriteDirImmediately |      LZ4 |  42.25 ms |     324.28 |           x1.4 |  1000.0000 | 1000.0000 | 1000.0000 |  65.88 MB |
| Single |         1 |     8192 |                   0 |     None |  12.28 ms |    1711.36 |           11.8 |  1000.0000 | 1000.0000 | 1000.0000 |  86.32 MB |
| Single |         1 |     8192 |                   0 |     GZip | 379.35 ms |      34.21 |           x1.4 |  2000.0000 | 1000.0000 | 1000.0000 |  83.27 MB |
| Single |         1 |     8192 |                   0 |      LZ4 |  39.90 ms |     397.85 |           x1.2 |  1000.0000 | 1000.0000 | 1000.0000 |  67.48 MB |
| Single |         1 |     8192 | WriteDirImmediately |     None |  39.67 ms |     529.55 |           11.8 |  5000.0000 | 1000.0000 | 1000.0000 | 113.19 MB |
| Single |         1 |     8192 | WriteDirImmediately |     GZip | 505.98 ms |      25.65 |           x1.4 |  6000.0000 | 1000.0000 | 1000.0000 |  113.8 MB |
| Single |         1 |     8192 | WriteDirImmediately |      LZ4 |  66.45 ms |     238.91 |           x1.2 |  5000.0000 | 1000.0000 | 1000.0000 |  97.34 MB |
| Single |         5 |     8192 |                   0 |     None |  12.52 ms |    1677.69 |           11.8 |  1000.0000 | 1000.0000 | 1000.0000 |  86.36 MB |
| Single |         5 |     8192 |                   0 |     GZip | 379.38 ms |      34.21 |           x1.4 |  2000.0000 | 1000.0000 | 1000.0000 |  83.33 MB |
| Single |         5 |     8192 |                   0 |      LZ4 |  40.12 ms |     395.64 |           x1.2 |  1000.0000 | 1000.0000 | 1000.0000 |  67.52 MB |
| Single |         5 |     8192 | WriteDirImmediately |     None |  17.85 ms |    1177.02 |           11.8 |  2000.0000 | 1000.0000 | 1000.0000 |  91.68 MB |
| Single |         5 |     8192 | WriteDirImmediately |     GZip | 404.55 ms |      32.08 |           x1.4 |  3000.0000 | 1000.0000 | 1000.0000 |  89.38 MB |
| Single |         5 |     8192 | WriteDirImmediately |      LZ4 |  50.05 ms |     317.18 |           x1.2 |  2000.0000 | 1000.0000 | 1000.0000 |  73.45 MB |
| Single |        10 |     8192 |                   0 |     None |  12.40 ms |    1694.68 |           11.8 |  1000.0000 | 1000.0000 | 1000.0000 |  86.34 MB |
| Single |        10 |     8192 |                   0 |     GZip | 378.45 ms |      34.29 |           x1.4 |  2000.0000 | 1000.0000 | 1000.0000 |  83.32 MB |
| Single |        10 |     8192 |                   0 |      LZ4 |  40.22 ms |     394.69 |           x1.2 |  1000.0000 | 1000.0000 | 1000.0000 |  67.51 MB |
| Single |        10 |     8192 | WriteDirImmediately |     None |  17.04 ms |    1233.21 |           11.8 |  2000.0000 | 1000.0000 | 1000.0000 |  89.03 MB |
| Single |        10 |     8192 | WriteDirImmediately |     GZip | 394.50 ms |      32.89 |           x1.4 |  3000.0000 | 1000.0000 | 1000.0000 |  86.37 MB |
| Single |        10 |     8192 | WriteDirImmediately |      LZ4 |  47.51 ms |     334.14 |           x1.2 |  2000.0000 | 1000.0000 | 1000.0000 |   70.5 MB |
| Single |        25 |     8192 |                   0 |     None |  13.09 ms |    1605.43 |           11.8 |  1000.0000 | 1000.0000 | 1000.0000 |  86.33 MB |
| Single |        25 |     8192 |                   0 |     GZip | 378.90 ms |      34.25 |           x1.4 |  2000.0000 | 1000.0000 | 1000.0000 |   83.3 MB |
| Single |        25 |     8192 |                   0 |      LZ4 |  41.36 ms |     383.79 |           x1.2 |  1000.0000 | 1000.0000 | 1000.0000 |   67.5 MB |
| Single |        25 |     8192 | WriteDirImmediately |     None |  14.25 ms |    1473.91 |           11.8 |  1000.0000 | 1000.0000 | 1000.0000 |  87.37 MB |
| Single |        25 |     8192 | WriteDirImmediately |     GZip | 384.34 ms |      33.76 |           x1.4 |  2000.0000 | 1000.0000 | 1000.0000 |  84.48 MB |
| Single |        25 |     8192 | WriteDirImmediately |      LZ4 |  45.03 ms |     352.58 |           x1.2 |  2000.0000 | 1000.0000 | 1000.0000 |  68.65 MB |
| Single |         1 |    32768 |                   0 |     None |  14.79 ms |    2069.19 |           39.5 |  3000.0000 | 1000.0000 | 1000.0000 |  96.76 MB |
| Single |         1 |    32768 |                   0 |     GZip | 393.14 ms |      58.58 |           x0.8 |  5000.0000 | 2000.0000 | 2000.0000 | 125.72 MB |
| Single |         1 |    32768 |                   0 |      LZ4 |  47.93 ms |     537.91 |           x0.7 |  3000.0000 | 2000.0000 | 1000.0000 | 109.93 MB |
| Single |         1 |    32768 | WriteDirImmediately |     None |  40.92 ms |     747.66 |           39.5 |  8000.0000 | 1000.0000 | 1000.0000 | 144.39 MB |
| Single |         1 |    32768 | WriteDirImmediately |     GZip | 516.01 ms |      44.63 |           x0.8 | 11000.0000 | 2000.0000 | 2000.0000 | 177.02 MB |
| Single |         1 |    32768 | WriteDirImmediately |      LZ4 |  77.27 ms |     333.66 |           x0.7 |  9000.0000 | 1000.0000 | 1000.0000 | 160.49 MB |
| Single |         5 |    32768 |                   0 |     None |  15.67 ms |    1952.23 |           39.5 |  3000.0000 | 1000.0000 | 1000.0000 |   96.8 MB |
| Single |         5 |    32768 |                   0 |     GZip | 390.48 ms |      58.98 |           x0.8 |  5000.0000 | 2000.0000 | 2000.0000 | 125.78 MB |
| Single |         5 |    32768 |                   0 |      LZ4 |  48.84 ms |     527.92 |           x0.7 |  3000.0000 | 2000.0000 | 1000.0000 | 109.97 MB |
| Single |         5 |    32768 | WriteDirImmediately |     None |  19.59 ms |    1561.56 |           39.5 |  4000.0000 | 1000.0000 | 1000.0000 | 106.24 MB |
| Single |         5 |    32768 | WriteDirImmediately |     GZip | 415.20 ms |      55.47 |           x0.8 |  6000.0000 | 3000.0000 | 2000.0000 | 135.95 MB |
| Single |         5 |    32768 | WriteDirImmediately |      LZ4 |  46.55 ms |     553.82 |           x0.7 |  4000.0000 | 1000.0000 | 1000.0000 |    120 MB |
| Single |        10 |    32768 |                   0 |     None |  17.01 ms |    1798.31 |           39.5 |  3000.0000 | 1000.0000 | 1000.0000 |  96.79 MB |
| Single |        10 |    32768 |                   0 |     GZip | 389.73 ms |      59.10 |           x0.8 |  5000.0000 | 2000.0000 | 2000.0000 | 125.77 MB |
| Single |        10 |    32768 |                   0 |      LZ4 |  47.14 ms |     546.86 |           x0.7 |  3000.0000 | 2000.0000 | 1000.0000 | 109.96 MB |
| Single |        10 |    32768 | WriteDirImmediately |     None |  16.02 ms |    1910.04 |           39.5 |  3000.0000 | 1000.0000 | 1000.0000 | 101.53 MB |
| Single |        10 |    32768 | WriteDirImmediately |     GZip | 401.51 ms |      57.36 |           x0.8 |  5000.0000 | 2000.0000 | 2000.0000 | 130.87 MB |
| Single |        10 |    32768 | WriteDirImmediately |      LZ4 |  51.72 ms |     498.45 |           x0.7 |  3000.0000 | 1000.0000 | 1000.0000 |    115 MB |
| Single |        25 |    32768 |                   0 |     None |  14.30 ms |    2139.21 |           39.5 |  3000.0000 | 1000.0000 | 1000.0000 |  96.78 MB |
| Single |        25 |    32768 |                   0 |     GZip | 388.60 ms |      59.27 |           x0.8 |  5000.0000 | 2000.0000 | 2000.0000 | 125.76 MB |
| Single |        25 |    32768 |                   0 |      LZ4 |  48.09 ms |     536.06 |           x0.7 |  3000.0000 | 2000.0000 | 1000.0000 | 109.95 MB |
| Single |        25 |    32768 | WriteDirImmediately |     None |  14.37 ms |    2129.48 |           39.5 |  3000.0000 | 1000.0000 | 1000.0000 |  98.61 MB |
| Single |        25 |    32768 | WriteDirImmediately |     GZip | 395.29 ms |      58.26 |           x0.8 |  5000.0000 | 2000.0000 | 2000.0000 | 127.74 MB |
| Single |        25 |    32768 | WriteDirImmediately |      LZ4 |  48.89 ms |     527.37 |           x0.7 |  3000.0000 | 1000.0000 | 1000.0000 | 111.89 MB |
